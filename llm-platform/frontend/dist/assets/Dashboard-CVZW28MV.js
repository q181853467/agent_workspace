import{k as R,r as g,d as E,l as m,q as s,u as d,G as e,A as a,a8 as l,z,C as L,ak as O,E as v,F as T,Y as U,m as _}from"./vue-vendor-CBcJ4V7k.js";import{u as G}from"./index-DzVZk42n.js";import{u as H}from"./models-BBVZaHDl.js";import{a as W}from"./apiKeys-CluY4eWM.js";import{a as $}from"./admin-BeQPA_vV.js";import{f as Y,g as j}from"./index-DcR-k5ux.js";import{u as J,H as Q,i as X,a as Z,b as tt,c as st,d as et,e as at,f as ot}from"./charts-BvHsk1LS.js";import{R as c,O as nt}from"./element-plus-CLNn8XtP.js";import{_ as lt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const it={class:"dashboard"},dt={class:"dashboard-header"},rt={class:"stats-grid"},ct={class:"stat-content"},_t={class:"stat-icon primary"},ut={class:"stat-info"},mt={class:"stat-value"},vt={class:"stat-content"},pt={class:"stat-icon success"},ft={class:"stat-info"},ht={class:"stat-value"},yt={class:"stat-content"},gt={class:"stat-icon warning"},kt={class:"stat-info"},bt={class:"stat-value"},xt={class:"stat-content"},wt={class:"stat-icon info"},Ct={class:"stat-info"},St={class:"stat-value"},At={class:"content-grid"},zt={class:"action-buttons"},$t={class:"card-header"},Mt={key:0,class:"loading"},qt={key:1,class:"models-list"},Dt=["onClick"],It={class:"model-info"},Nt={class:"model-name"},Pt={class:"model-provider"},Vt={class:"model-status"},Bt={class:"card-header"},Kt={class:"chart-container"},Ft={key:1,class:"no-data"},Rt=R({__name:"Dashboard",setup(Et){J([X,Z,tt,st,et,at,ot]);const u=O(),p=G(),f=H(),k=g({total_requests:0,avg_latency:0}),w=g(0),b=g("7"),x=g(null),M=i=>{f.selectModel(i),nt.success(`已选择模型：${i.display_name}`),u.push("/chat")},q=async()=>{try{const i=await W.getApiKeys();if(w.value=i.length,p.isAdmin){const t=await $.getOverviewStats();k.value={total_requests:t.recent_api_calls_24h,avg_latency:Math.round(t.avg_latency_ms)}}}catch(i){console.error("Failed to load stats:",i)}},C=async()=>{try{if(!p.isAdmin)return;const i=await $.getUsageStats(parseInt(b.value)),t=i.daily_stats.map(o=>o.date),y=i.daily_stats.map(o=>o.request_count),r=i.daily_stats.map(o=>Math.round(o.avg_latency_ms));x.value={title:{text:"请求统计",left:"center",textStyle:{fontSize:14,fontWeight:"normal"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:["请求数","平均延迟(ms)"],bottom:0},xAxis:{type:"category",data:t,axisLabel:{formatter:o=>new Date(o).toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}},yAxis:[{type:"value",name:"请求数",position:"left"},{type:"value",name:"延迟(ms)",position:"right"}],series:[{name:"请求数",type:"bar",data:y,itemStyle:{color:"#6366f1"}},{name:"平均延迟(ms)",type:"line",yAxisIndex:1,data:r,itemStyle:{color:"#06b6d4"}}]}}catch(i){console.error("Failed to load chart data:",i)}};return E(async()=>{await Promise.all([f.fetchActiveModels(),q()]),p.isAdmin&&C()}),(i,t)=>{const y=l("ChatDotRound"),r=l("el-icon"),o=l("el-card"),D=l("Box"),S=l("Key"),I=l("Timer"),h=l("el-button"),N=l("Monitor"),P=l("Setting"),V=l("el-skeleton"),B=l("el-tag"),A=l("el-option"),K=l("el-select"),F=l("el-empty");return _(),m("div",it,[s("div",dt,[s("h1",null,"欢迎回来，"+c(d(p).userName)+"！",1),t[6]||(t[6]=s("p",null,"这里是您的个人仪表板",-1))]),s("div",rt,[e(o,{class:"stat-card",shadow:"hover"},{default:a(()=>[s("div",ct,[s("div",_t,[e(r,{size:"24"},{default:a(()=>[e(y)]),_:1})]),s("div",ut,[s("div",mt,c(d(Y)(k.value.total_requests||0)),1),t[7]||(t[7]=s("div",{class:"stat-label"},"总请求数",-1))])])]),_:1}),e(o,{class:"stat-card",shadow:"hover"},{default:a(()=>[s("div",vt,[s("div",pt,[e(r,{size:"24"},{default:a(()=>[e(D)]),_:1})]),s("div",ft,[s("div",ht,c(d(f).activeModels.length),1),t[8]||(t[8]=s("div",{class:"stat-label"},"可用模型",-1))])])]),_:1}),e(o,{class:"stat-card",shadow:"hover"},{default:a(()=>[s("div",yt,[s("div",gt,[e(r,{size:"24"},{default:a(()=>[e(S)]),_:1})]),s("div",kt,[s("div",bt,c(w.value),1),t[9]||(t[9]=s("div",{class:"stat-label"},"API 密钥",-1))])])]),_:1}),e(o,{class:"stat-card",shadow:"hover"},{default:a(()=>[s("div",xt,[s("div",wt,[e(r,{size:"24"},{default:a(()=>[e(I)]),_:1})]),s("div",Ct,[s("div",St,c(k.value.avg_latency||0)+"ms",1),t[10]||(t[10]=s("div",{class:"stat-label"},"平均延迟",-1))])])]),_:1})]),s("div",At,[e(o,{class:"quick-actions",shadow:"hover"},{header:a(()=>t[11]||(t[11]=[s("div",{class:"card-header"},[s("span",null,"快速操作")],-1)])),default:a(()=>[s("div",zt,[e(h,{type:"primary",size:"large",onClick:t[0]||(t[0]=n=>d(u).push("/chat"))},{default:a(()=>[e(r,null,{default:a(()=>[e(y)]),_:1}),t[12]||(t[12]=v(" 开始对话 "))]),_:1,__:[12]}),e(h,{size:"large",onClick:t[1]||(t[1]=n=>d(u).push("/api-keys"))},{default:a(()=>[e(r,null,{default:a(()=>[e(S)]),_:1}),t[13]||(t[13]=v(" 创建 API 密钥 "))]),_:1,__:[13]}),e(h,{size:"large",onClick:t[2]||(t[2]=n=>d(u).push("/test"))},{default:a(()=>[e(r,null,{default:a(()=>[e(N)]),_:1}),t[14]||(t[14]=v(" API 测试 "))]),_:1,__:[14]}),d(p).isAdmin?(_(),z(h,{key:0,size:"large",onClick:t[3]||(t[3]=n=>d(u).push("/admin"))},{default:a(()=>[e(r,null,{default:a(()=>[e(P)]),_:1}),t[15]||(t[15]=v(" 系统管理 "))]),_:1,__:[15]})):L("",!0)])]),_:1}),e(o,{class:"recent-models",shadow:"hover"},{header:a(()=>[s("div",$t,[t[17]||(t[17]=s("span",null,"可用模型",-1)),e(h,{text:"",type:"primary",onClick:t[4]||(t[4]=n=>d(u).push("/models"))},{default:a(()=>t[16]||(t[16]=[v(" 查看全部 ")])),_:1,__:[16]})])]),default:a(()=>[d(f).loading?(_(),m("div",Mt,[e(V,{rows:3,animated:""})])):(_(),m("div",qt,[(_(!0),m(T,null,U(d(f).activeModels.slice(0,5),n=>(_(),m("div",{key:n.id,class:"model-item",onClick:Lt=>M(n)},[s("div",It,[s("div",Nt,c(n.display_name),1),s("div",Pt,c(d(j)(n.provider))+" "+c(n.provider),1)]),s("div",Vt,[e(B,{type:n.is_active?"success":"danger",size:"small"},{default:a(()=>[v(c(n.is_active?"活跃":"停用"),1)]),_:2},1032,["type"])])],8,Dt))),128))]))]),_:1}),e(o,{class:"usage-chart",shadow:"hover"},{header:a(()=>[s("div",Bt,[t[18]||(t[18]=s("span",null,"使用统计",-1)),e(K,{modelValue:b.value,"onUpdate:modelValue":t[5]||(t[5]=n=>b.value=n),size:"small",style:{width:"100px"},onChange:C},{default:a(()=>[e(A,{label:"7天",value:"7"}),e(A,{label:"30天",value:"30"})]),_:1},8,["modelValue"])])]),default:a(()=>[s("div",Kt,[x.value?(_(),z(d(Q),{key:0,option:x.value,class:"chart",autoresize:""},null,8,["option"])):(_(),m("div",Ft,[e(F,{description:"暂无数据"})]))])]),_:1})])])}}}),Qt=lt(Rt,[["__scopeId","data-v-e75446cb"]]);export{Qt as default};
